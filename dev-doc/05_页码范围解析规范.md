## 05_页码范围解析规范（简版）

### 1) 输入语法

* 支持：

  * 单页：`3`
  * 列表：`1,3,8`
  * 区间：`5-10`
  * 组合：`1,3,5-10`
* 允许空格：`1, 3, 5 - 10`（解析时应忽略空格）
* 逗号分隔符仅支持英文逗号 `,`（中文逗号 `，` 可作为增强：自动替换）

### 2) 页码基准

* 页码从 **1 开始**
* 解析时需要知道 `totalPages`（PDF 总页数）

### 3) 合法性与容错规则（推荐）

* 空输入 / 全空格：表示 **全部页**（`1..totalPages`）
* 区间允许写反：`10-5` 等价于 `5-10`
* 去重并排序：`3,1,3` → `[1,3]`
* 越界页码：

  * 推荐策略：**忽略越界并给出提示**（UI 警告，不阻止开始）
  * 例如 `0,1,999`（total=10）→ `[1]` 且提示“已忽略越界页码：0,999”
* 非法片段（无法解析为页码或区间）：

  * 推荐策略：**视为错误并阻止开始**（因为用户往往是输入错了）
  * 例如 `1,a,3` 或 `1--3` → 提示“页码范围格式错误”

> 也可以选“尽量解析 + 警告”，但桌面工具里更建议“非法就阻止”，减少用户误操作导致漏页。

### 4) 输出定义

* 输出为 `List<int>`（1-based）：

  * 已排序、去重
  * 只包含 `[1..totalPages]` 范围内页码
* 同时输出 `ParseWarnings`（可选）：

  * 被忽略的越界值
  * 被纠正的反向区间（可选提示）
  * 被替换的中文逗号（可选提示）

### 5) 参考实现逻辑（不贴全代码版）

* 预处理：`trim`、将中文逗号 `，` 替换为 `,`（增强项）
* `split(',')` 得到 token
* token 若含 `-`：按区间处理；否则按单页处理
* 全部合法页加入 `SortedSet<int>`（天然去重+排序）
* 结束后若集合为空：提示“页码范围为空或全部越界”

### 6) 建议单元测试用例（最少集）

* `""`（total=10）→ 1..10
* `"1"` → [1]
* `"1,3,5-10"` → [1,3,5,6,7,8,9,10]
* `"10-5"` → [5..10]
* `" 1 , 3 , 5 - 10 "` → 同上
* `"0,1,11"`（total=10）→ [1] + 警告（忽略0,11）
* `"1,a,3"` → 错误
* `"1,,3"` → 错误或忽略空 token（二选一，建议错误以提醒用户）
