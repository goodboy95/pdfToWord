<Window x:Class="Pdf2Word.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Pdf2Word" Height="760" Width="1100" Background="{StaticResource LightBackground}">
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="0,0,20,0">
                <TextBlock FontSize="24" FontWeight="Bold" Text="PDF 转 Word" Margin="0,0,0,12" />

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="输入 PDF" />
                        <DockPanel Margin="0,6,0,0">
                            <TextBox Text="{Binding PdfPath, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="420" />
                            <Button Content="选择..." Command="{Binding BrowsePdfCommand}" Margin="8,0,0,0" />
                        </DockPanel>
                        <TextBlock Foreground="#666" FontSize="12" Text="支持图片型/扫描型 PDF" Margin="0,4,0,0" />
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="页码范围" />
                        <TextBox Text="{Binding PageRangeText, UpdateSourceTrigger=PropertyChanged}" Margin="0,6,0,0" />
                        <TextBlock Foreground="#666" FontSize="12" Text="留空=全部页；例如 1,3,5-10" Margin="0,4,0,0" />
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="页眉页脚去除" />
                        <ComboBox ItemsSource="{Binding HeaderFooterModes}" SelectedItem="{Binding HeaderFooterMode}" Margin="0,6,0,0" />
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <StackPanel Width="120">
                                <TextBlock Text="页眉裁切" FontSize="12" Foreground="#666" />
                                <TextBox Text="{Binding HeaderPercent}" />
                            </StackPanel>
                            <StackPanel Width="120" Margin="12,0,0,0">
                                <TextBlock Text="页脚裁切" FontSize="12" Foreground="#666" />
                                <TextBox Text="{Binding FooterPercent}" />
                            </StackPanel>
                        </StackPanel>
                        <TextBlock Foreground="#666" FontSize="12" Text="比例范围 0~0.2，默认 0.06" Margin="0,4,0,0" />
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="页面尺寸" />
                        <ComboBox ItemsSource="{Binding PageSizeModes}" SelectedItem="{Binding PageSizeMode}" Margin="0,6,0,0" />
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="高级设置" />
                        <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                            <StackPanel Width="120">
                                <TextBlock Text="DPI" FontSize="12" Foreground="#666" />
                                <ComboBox ItemsSource="{Binding DpiOptions}" SelectedItem="{Binding Dpi}" />
                            </StackPanel>
                            <StackPanel Width="120" Margin="12,0,0,0">
                                <TextBlock Text="并发" FontSize="12" Foreground="#666" />
                                <ComboBox ItemsSource="{Binding ConcurrencyOptions}" SelectedItem="{Binding Concurrency}" />
                            </StackPanel>
                            <StackPanel Width="160" Margin="12,0,0,0">
                                <TextBlock Text="倾斜校正" FontSize="12" Foreground="#666" />
                                <CheckBox Content="启用" IsChecked="{Binding DeskewEnabled}" />
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <StackPanel Width="420">
                                <TextBlock Text="Gemini API Key" FontSize="12" Foreground="#666" />
                                <TextBox Text="{Binding GeminiApiKey, UpdateSourceTrigger=PropertyChanged}" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontWeight="SemiBold" Text="输出" />
                        <DockPanel Margin="0,6,0,0">
                            <TextBox Text="{Binding OutputPath, UpdateSourceTrigger=PropertyChanged}" Width="420" />
                            <Button Content="选择..." Command="{Binding BrowseOutputCommand}" Margin="8,0,0,0" />
                        </DockPanel>
                        <CheckBox Content="保留诊断文件" IsChecked="{Binding KeepDiagnostics}" Margin="0,6,0,0" />
                    </StackPanel>
                </Border>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <Button Content="开始转换" Command="{Binding StartCommand}" Background="{StaticResource AccentBrush}" Foreground="White" IsEnabled="{Binding CanStart}" Width="120" />
                    <Button Content="取消" Command="{Binding CancelCommand}" Margin="8,0,0,0" IsEnabled="{Binding IsBusy}" />
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Column="1" Background="White" CornerRadius="8" Padding="16">
            <StackPanel>
                <TextBlock FontWeight="SemiBold" Text="进度与日志" />
                <ProgressBar Minimum="0" Maximum="100" Value="{Binding ProgressPercent}" Height="16" Margin="0,8,0,0" />
                <TextBlock Text="{Binding ProgressText}" Margin="0,6,0,12" />

                <TextBlock FontWeight="SemiBold" Text="日志" />
                <ListBox ItemsSource="{Binding Logs}" Height="320" Margin="0,6,0,0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}" FontSize="12" TextWrapping="Wrap" />
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <TextBlock FontWeight="SemiBold" Text="失败页" Margin="0,12,0,0" />
                <ListBox ItemsSource="{Binding Failures}" Height="150" Margin="0,6,0,0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}" FontSize="12" TextWrapping="Wrap" />
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Border>
    </Grid>
</Window>
